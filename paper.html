<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Summary • purify</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Summary"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">purify</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="articles/purify.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/cats.html">cats</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jrvanderdoes/purify/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Summary</h1>
      <small class="dont-index">Source: <a href="https://github.com/jrvanderdoes/purify/blob/main/paper.md" class="external-link"><code>paper.md</code></a></small>
    </div>


<div id="summary" class="section level1">

<p><code>Purify</code> is an R package designed for resampling and testing of data, aimed at researchers and practitioners who analyze complex datasets with a potentially dependent output variable and multiple predictors. This package enables users to perform robust statistical analyses by allowing resampling of variables with and without relation to the output variable. Analyses can be focused on results such as statistical summaries (e.g. mean square error) and coefficient estimates of models. <code>Purify</code> offers versatile resampling methods, including block, sliding window, and stratified resampling. These methods are also extended to cross-validation and prediction confidence intervals. Each can be tailored to specific data structures and research questions. With its intuitive interface and customizable options, <code>Purify</code> streamlines the process of hypothesis testing and estimation of statistical significance.</p>
</div>
<div class="section level1">
<h1 id="statement-of-need">Statement of need<a class="anchor" aria-label="anchor" href="#statement-of-need"></a></h1>
<p>Resampling is fundamental technique in estimating the distribution of a statistic, testing hypotheses, and deriving confidence intervals, especially when analytical solutions are impractical. Many R packages provide basic resampling methods but lack specialized support for complex structures. Such structures may contain dependence and variables which should not be resampled. Analysis of these structures can be unwieldy to investigate in other packages. <code>Purify</code> fills this gap by providing a flexible framework to enable data scientists and researchers to perform and compare targeted, customizable resampling schemes that account for data structure. Further, the methods allow for user-defined functions, allowing use of outside models, making <code>Purify</code> ideal for rigorous hypothesis testing and model evaluation.</p>
<p>The package’s support for stratified and segmented sampling further allows users to address scenarios with grouped or ordered data (even under dependence), providing a critical resource for modern applied statistical research. By incorporating sophisticated resampling techniques, <code>Purify</code> enhances the robustness and reliability of statistical inferences drawn from complex (in particular unbalanced) datasets.</p>
<p>Permutation tests can be naturally computational intensive and speed is an important consideration throughout <code>Purify</code>. Users can use it in a variety of problems. Additional functions provide use of resampling in the context of cross-validation. Supplemental functions provide visualizations and summary functions to illuminate the methods and results. Detailed documentation makes <code>Purify</code> accessible to users of varying statistical understanding.</p>
<div class="float">
<img src="articles/cat_overview.png" style="width:100.0%" alt="Subcats. Body and heart weights of cats with respect to their sex."><div class="figcaption">
<strong>Subcats.</strong> Body and heart weights of cats with respect to their sex.</div>
</div>
</div>
<div class="section level1">
<h1 id="package-functionality">Package Functionality<a class="anchor" aria-label="anchor" href="#package-functionality"></a></h1>
<p>A primary function in <code>Purify</code> is <code><a href="reference/resample.html">resample()</a></code>. The function offers clear input parameters to simplify the process of selecting the correct methodology. The multistep selection allows for combinations of dependent data, unbalanced data, and resampling to be performed with and without replacement. The flexibility enables users to adapt <code>Purify</code> to diverse data contexts and hypothesis-testing requirements. See also <code><a href="reference/cross_validation.html">cross_validation()</a></code> and <code><a href="reference/confidence_intervals.html">confidence_intervals()</a></code>.</p>
<p>Supporting functions such as <code><a href="reference/summarize_resample.html">summarize_resample()</a></code> provide additional information to the user. Visualization such as <code><a href="reference/plot_strata_bar.html">plot_strata_bar()</a></code> or <code>plot_strat_box()</code> visualize group sizes in stratified samples.</p>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a></h2>
<p><code>Purify</code> provides several in-depth vignettes in the package or at its <a href="https://jrvanderdoes.github.io/purify/">website</a>. For example,</p>
<ul><li>The <em>purify</em> vignette describes the core features of `purify’ and includes simulations and real data examples to demonstrate the functions.</li>
<li>The <em>cats</em> vignette details investigation on real data.</li>
</ul><p>We consider a subset of the cats (<em>subcats</em>) data set below, where we use sex and body weight to estimate heart weight; see . As seen in many real-world examples, the data is highly imbalanced. Nonetheless, sex and body weight are both useful in understanding heart weight. In particular, female cats have lower body weights and have a lower heart weight even for the same body weight when compared to male cats.</p>
<table style="width:97%;" class="table"><caption>
<strong>Subcats models.</strong> Models of cats using body weight and sex to predict heart weight.</caption>
<colgroup><col width="21%"><col width="19%"><col width="18%"><col width="18%"><col width="18%"></colgroup><thead><tr class="header"><th align="center"></th>
<th align="center">Intercept<br>
95% Conf Int</th>
<th align="center">Sex (M)<br>
95% Conf Int</th>
<th align="center">Body weight<br>
95% Conf Int</th>
<th align="center">MSE</th>
</tr></thead><tbody></tbody><tfoot><tr class="odd"><td align="center">Single model</td>
<td align="center">-1.486<br>
(-3.236, 0.264)</td>
<td align="center">0.617<br>
(-0.139, 1.372)</td>
<td align="center">4.208<br>
(3.573, 4.843)</td>
<td align="center">2.258</td>
</tr><tr class="even"><td align="center">Resampled model</td>
<td align="center">-1.427<br>
(-3.603, 0.610)</td>
<td align="center">0.620<br>
(0.051, 1.167)</td>
<td align="center">4.186<br>
(3.425, 5.005)</td>
<td align="center">2.192</td>
</tr></tfoot></table><p>Let the linear model be defined as heart weight being predicted by a intercept, body weight and sex. Estimates for the coefficients and the confidence intervals for each parameter are given in . When applying the linear model directly on the data, only body weights appear to significantly impact heart weight. For resampled data, where samples are taken to create more evenly sized groups based on sex, both sex and body weight are determined to be significant. The cost for this simple example is that the confidence interval on body weight is larger. While additional simulations, or modifying the resampling scheme may mitigate such losses, it is important to consider such effects. Often the prediction errors, e.g. mean square error (MSE), is more important and in this case, the resampled model also performs better. See vignettes for additional analysis on this and other data.</p>
<!--
library(purify)
library(ggplot2)

png('./vignettes/cat_overview.png', width=1200, height=800)
ggplot() +
  geom_point(aes(x=Bwt, y=Hwt, col=Sex,shape = Sex),data=subcats, size=8) +
  theme_bw() +
  theme(axis.title = element_text(size=40),
        axis.text = element_text(size=36),
        legend.position = c(.2, .8),
        legend.title = element_blank(),
        legend.text = element_text(size=36)) +
  scale_color_discrete(labels = c('Female', 'Male')) +
  scale_shape_manual(labels = c('Female', 'Male'),
                       values = c(16,3)) +
  xlab('Body weight (kg)') +
  ylab('Heart weight (g)')
dev.off()

summ_function <- function(data) {
  coef(summary(lm(Hwt ~ ., data = data)))
}

set.seed(1234)
tmp <- lm(Hwt ~ ., data =subcats)
coef(summary(tmp))
confint(tmp)
# summ_function(subcats)

# # Perform resampling
# results <- resample(data = subcats, fn = summ_function, M = 1000,
#                              strata='Sex',sizes=mean)
# summarize_resample(results)

###########

# Does CV on each sample so that we get result comparable to CV
#   e.g. fitting on one less data and predicting the missing
mse_function1 <- function(data) {

  cv <- cross_validation(data = data,
                 pred_fn = function(data,nd){
                   as.numeric(predict(lm(Hwt ~ ., data = data),newdata = nd) )
                 },
                 error_fn = function(true,est){
                   mean((true$Hwt - est)^2)
                 })
  mod <- lm(Hwt ~ ., data=data)
  c(cv[[1]], as.numeric(coef(summary(mod))[,1]) )

  # mod <- lm(Hwt ~ ., data=data)
  # pred <- as.numeric(predict( mod , new_data=cv_data) )
  # c(mean((data$Hwt - pred)^2), as.numeric(coef(summary(mod))[,1]) )
}

set.seed(1234)
results <- resample(
  data = subcats, fn = mse_function1,
  M = 1000, strata = "Sex"
)

cross_validation(data = subcats,
                 pred_fn = function(data,nd){
                   as.numeric(predict(lm(Hwt ~ ., data = data),newdata = nd) )
                 },
                 error_fn = function(true,est){
                   mean((true$Hwt - est)^2)
                 })
summarize_resample(results)
-->
</div>
</div>
<div class="section level1">
<h1 id="implementation">Implementation<a class="anchor" aria-label="anchor" href="#implementation"></a></h1>
<p><code>Purify</code> is implemented in R, following standard stylization and using vectorized operations for efficient computation. The package’s modular design and clear documentation make it easy to adapt to various research needs, allowing users to integrate their own statistical functions or modify resampling parameters to meet specific analytical requirements. <code>Purify</code> has been used in @tetui:etal:2022, @scsrubook, and @alexander:hall:chen:2024.</p>
</div>
<div class="section level1">
<h1 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a></h1>
<p>Development of the <code>Purify</code> package was inspired by foundational methods in statistical resampling and permutation testing. Special thanks to the open-source R community for support and resources.</p>
<p>Contributions to <code>Purify</code> are welcome and notable recognition is given to all who raise awareness of deficiencies in the package via the GitHub repository.</p>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h1>
</div>


  </main></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jeremy VanderDoes, Yuling Chen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

