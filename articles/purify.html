<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>purify • purify</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="purify">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">purify</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/purify.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/cats.html">cats</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jrvanderdoes/purify/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>purify</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jrvanderdoes/purify/blob/main/vignettes/articles/purify.Rmd" class="external-link"><code>vignettes/articles/purify.Rmd</code></a></small>
      <div class="d-none name"><code>purify.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Welcome to `purify’! This article will outline the main functions and
offer many valuable simulations for these functions. Real data examples
can be found in other articles.</p>
<p>`Purify’ comes from its purpose of permutation tests and
stratification for data. It can be used to purify data and mitigate
confounding effects, particularly when looking at strata which are much
smaller than other strata.</p>
<p>The data can be found on GitHub and can be loaded as:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrvanderdoes/purify" class="external-link">purify</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulations">Simulations<a class="anchor" aria-label="anchor" href="#simulations"></a>
</h2>
<p>Let the data be generated as follows.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span></span>
<span><span class="va">data_strat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">"y"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n</span><span class="op">)</span>,</span>
<span>  <span class="st">"x"</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="st">"z"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.65</span>, <span class="fl">0.3</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"w"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">75</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">data_strat</span><span class="op">[</span><span class="va">data_strat</span><span class="op">$</span><span class="va">z</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="st">"x"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">data_strat</span><span class="op">[</span><span class="va">data_strat</span><span class="op">$</span><span class="va">z</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="st">"x"</span><span class="op">]</span><span class="op">)</span>, <span class="fl">40</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">data_strat</span><span class="op">[</span><span class="va">data_strat</span><span class="op">$</span><span class="va">z</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="st">"x"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">data_strat</span><span class="op">[</span><span class="va">data_strat</span><span class="op">$</span><span class="va">z</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="st">"x"</span><span class="op">]</span><span class="op">)</span>, <span class="fl">60</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">data_strat</span><span class="op">[</span><span class="va">data_strat</span><span class="op">$</span><span class="va">z</span> <span class="op">==</span> <span class="st">"C"</span>, <span class="st">"x"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">data_strat</span><span class="op">[</span><span class="va">data_strat</span><span class="op">$</span><span class="va">z</span> <span class="op">==</span> <span class="st">"C"</span>, <span class="st">"x"</span><span class="op">]</span><span class="op">)</span>, <span class="fl">100</span>, <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_strat</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">data_strat</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>We see a major inbalance is the groups.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_strata_bar.html">plot_strata_bar</a></span><span class="op">(</span><span class="va">data_strat</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span></code></pre></div>
<p><img src="purify_files/figure-html/stratify_imbalance-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_strata_box.html">plot_strata_box</a></span><span class="op">(</span><span class="va">data_strat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="st">"x"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="purify_files/figure-html/stratify_imbalance-2.png" width="700"></p>
<p>Suppose we are interested in the following regression model.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">z</span> <span class="op">+</span> <span class="va">w</span>, data <span class="op">=</span> <span class="va">X</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The model on the original and resampled data can be computed.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">orig_coefs</span> <span class="op">&lt;-</span> <span class="fu">strat_function</span><span class="op">(</span><span class="va">data_strat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resample.html">resample</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_strat</span>, fn <span class="op">=</span> <span class="va">strat_function</span>,</span>
<span>  strata <span class="op">=</span> <span class="st">"z"</span>, sizes <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The results show resampling improved the estimates.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">orig_coefs</span></span>
<span><span class="co">#&gt;                Estimate  Std. Error   t value     Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept) 9.576796108 1.274266764 7.5155347 2.675532e-13</span></span>
<span><span class="co">#&gt; x           0.088091571 0.024632271 3.5762667 3.827606e-04</span></span>
<span><span class="co">#&gt; zB          1.349345740 1.145474836 1.1779794 2.393708e-01</span></span>
<span><span class="co">#&gt; zC          0.737367180 2.461056999 0.2996140 7.645974e-01</span></span>
<span><span class="co">#&gt; w           0.004762205 0.008959238 0.5315413 5.952822e-01</span></span>
<span><span class="fu"><a href="../reference/summarize_resample.html">summarize_resample</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt;             estimates        sd         lower     upper</span></span>
<span><span class="co">#&gt; (Intercept) 4.6103084 4.1380525  1.469803e-17 11.181240</span></span>
<span><span class="co">#&gt; x           0.9250942 1.6111655  1.266065e-06  4.905547</span></span>
<span><span class="co">#&gt; zB          1.0114499 0.8543926 -3.667802e-01  3.034361</span></span>
<span><span class="co">#&gt; zC          0.9709607 1.6346848 -2.645612e+00  3.853378</span></span>
<span><span class="co">#&gt; w           0.2442152 0.5695905 -7.473705e-01  1.756928</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="titanic-example">Titanic Example<a class="anchor" aria-label="anchor" href="#titanic-example"></a>
</h2>
<p>From a subset of titanic data, it may be natural to try to estimate
the survival of a passenger.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a custom function to calculate MSE</span></span>
<span><span class="va">mse_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Survived</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>      data <span class="op">=</span> <span class="va">data</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"response"</span></span>
<span>  <span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Survived</span> <span class="op">!=</span> <span class="va">pred</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Simple resampling</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resample.html">resample</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">titanic</span>, fn <span class="op">=</span> <span class="va">mse_function</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">1000</span>, strata <span class="op">=</span> <span class="st">"Pclass"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Resampling the data lead to lower mean squared error estimates.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Does CV on each sample</span></span>
<span><span class="co">#   Note, MSE uses all data while resample will be missing the CV part</span></span>
<span><span class="co">#   See cats article for modifications</span></span>
<span><span class="va">mse_function1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross_validation.html">cross_validation</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">data</span>,</span>
<span>    pred_fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">nd</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Survived</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>          data <span class="op">=</span> <span class="va">data</span>,</span>
<span>          family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"response"</span>, newdata <span class="op">=</span> <span class="va">nd</span></span>
<span>      <span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    error_fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">pred</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Survived</span> <span class="op">!=</span> <span class="va">pred</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Survived</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>    data <span class="op">=</span> <span class="va">data</span>,</span>
<span>    family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cv</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># mod &lt;- lm(Hwt ~ ., data=data)</span></span>
<span>  <span class="co"># pred &lt;- as.numeric(predict( mod , new_data=cv_data) )</span></span>
<span>  <span class="co"># c(mean((data$Hwt - pred)^2), as.numeric(coef(summary(mod))[,1]) )</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resample.html">resample</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">titanic</span>, fn <span class="op">=</span> <span class="va">mse_function</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">1000</span>, strata <span class="op">=</span> <span class="st">"Pclass"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mse_function</span><span class="op">(</span><span class="va">titanic</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.232902</span></span>
<span><span class="fu"><a href="../reference/summarize_resample.html">summarize_resample</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt;    estimates         sd     lower     upper</span></span>
<span><span class="co">#&gt; V1 0.2264991 0.01908357 0.1903882 0.2643253</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="german-credit-information">German Credit Information<a class="anchor" aria-label="anchor" href="#german-credit-information"></a>
</h2>
<p>Below is a simple analysis of German credit data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="co"># Define a custom function to calculate MSE</span></span>
<span><span class="va">mse_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Class</span><span class="op">)</span><span class="op">[</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Class</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>          data <span class="op">=</span> <span class="va">data</span>,</span>
<span>          family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        type <span class="op">=</span> <span class="st">"response"</span></span>
<span>      <span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.5</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>  <span class="op">]</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Class</span> <span class="op">!=</span> <span class="va">pred</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Perform resampling with the 'simple' method</span></span>
<span><span class="co">#   Note, MSE uses all data while resample will be missing the CV part</span></span>
<span><span class="co">#   See cats article for modifications</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resample.html">resample</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">credit</span>, fn <span class="op">=</span> <span class="va">mse_function</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">2000</span>, strata <span class="op">=</span> <span class="st">"Job"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/summarize_resample.html">summarize_resample</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt;    estimates       sd lower upper</span></span>
<span><span class="co">#&gt; V1  591.2495 270.1585   194   811</span></span>
<span><span class="fu">mse_function</span><span class="op">(</span><span class="va">credit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 770</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jeremy VanderDoes, Yuling Chen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
